# 2024-NC2-A18-Widgets-FaHe

## ë‹¬ì•„ë‹¬ì•„ 
 <img src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A18-Widgets/assets/121593683/2061f331-869c-4de8-b99b-9e70eb0068e3" width="256">

ë‹¬ì— ì‚¬ëŠ” ì—¬ìš°ëŠ” í–‡ë¹›ì´ ê°€ë ¤ì§€ëŠ” ìˆœê°„ í˜ì„ ë°œíœ˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì›”ì‹ì´ ì¼ì–´ë‚˜ëŠ” ë‚ , ë‹¬ì„ í–¥í•´ ì†Œì›ì„ ë¹Œë©´ ì—¬ìš°ê°€ ì†Œì›ì„ ë“¤ì–´ì¤ë‹ˆë‹¤. 

- ì ê¸ˆí™”ë©´ ë° í™ˆí™”ë©´ ìœ„ì ¯ì„ í†µí•´ ë‹¤ìŒ ì›”ì‹ê¹Œì§€ ë‚¨ì€ ì¼ìˆ˜ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
 
   <img width="305" alt="image" src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A18-Widgets/assets/121593683/1774e045-e1ca-462a-8622-ec7aac9c4fec">
   
   <img width="305" alt="image" src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A18-Widgets/assets/121593683/a03129a3-a130-4422-b90f-454602a0b419">


- ë‹¤ì´ë‹ˆë¯¹ ì•„ì¼ëœë“œë¥¼ ì´ìš©í•´ì„œ ì›”ì‹ ì§„í–‰ í˜„í™©ì„ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
<img width="426" alt="image" src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A18-Widgets/assets/121593683/11eeb43d-23e0-4e06-9606-a93e20cc4bf8">
<img width="426" alt="image" src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A18-Widgets/assets/121593683/95828113-d266-44b5-a26c-e9c0ffd2cfec">


- ì›”ì‹ì´ ì‹œì‘ì‹œ ì›”ì‹ ì§„í–‰ í˜„í™©ì„ ì ê¸ˆí™”ë©´ ë¼ì´ë¸Œ ì•¡í‹°ë¹„í‹°ë¥¼ í†µí•´ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
<img width="305" alt="image" src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A18-Widgets/assets/121593683/9a281da8-26ac-4b01-a01c-4e07c90d93ea">


## íŒ€ì› ì†Œê°œ 

<table style="width: 100%; table-layout: fixed;">
  <tr>
    <td style="text-align: center; padding: 10px;">
      <h3>íŒŒì¸</h3>
    </td>
    <td style="text-align: center; padding: 10px;">
      <h3>í—¤ì´ì¦</h3>
    </td>
  </tr>
  <tr>
    <td style="text-align: center; padding: 10px;">
      <img src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A18-Widgets/assets/121593683/ced8345c-a8a8-43fd-8312-9123a46baa65" width="256" alt="Image 1">
    </td>
    <td style="text-align: center; padding: 10px;">
      <img src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A18-Widgets/assets/121593683/b027759c-44a4-4fa2-a4c0-5fd790cd1067" width="256" alt="Image 2">
    </td>
  </tr>
</table>



## Widget ì´ë€?
ì•±ì„ ì—´ì§€ ì•Šê³  í•„ìš”í•œ ì •ë³´ë¥¼ í‘œì‹œí•˜ê³  íŠ¹ì • ê¸°ëŠ¥ì„ ì œê³µí•˜ë©° ì •ë³´ì™€ ê¸°ëŠ¥ì— ë¹ ë¥´ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 


## Widgetì€ ì–´ë””ì— ì“°ì£ ?
âœ…  ì•±ì˜ ì£¼ìš” ëª©ì ê³¼ ê´€ë ¨ì„±ì´ ìˆëŠ” ê°„ë‹¨í•œ ì •ë³´ë¥¼ í‘œì‹œ

âœ…  ì—¬ëŸ¬í¬ê¸°ì˜ ìœ„ì ¯ì„ ì œê³µí•˜ëŠ” ê²ƒì€ ì¢‹ì§€ë§Œ, ì‘ì€ ìœ„ì ¯ìœ¼ë¡œë„ ì¶©ë¶„í•œ ë‚´ìš©ì„ í° ìœ„ì ¯ìœ¼ë¡œ í™•ì¥í•˜ëŠ” ê²ƒì€ ì§€ì–‘â€¨( í° ìœ„ì ¯ì„ ì‚¬ìš©í•  ìˆ˜ë¡ ì¶”ê°€ ì •ë³´ë¥¼ ë³´ì—¬ì£¼ëŠ” ê²ƒì´ ì¢‹ìŒ )

âœ…  ì‚¬ëŒë“¤ì´ ì›í•˜ëŠ” ì½˜í…ì¸ ì— ë¹ ë¥´ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ìœ„ì ¯ì„ í„°ì¹˜í–ˆì„ ë•Œ í•´ë‹¹ ì •ë³´ì™€ ê´€ë ¨ëœ í˜ì´ì§€ë¥¼ ë„ì›Œì£¼ëŠ” ê²ƒì´ ì¢‹ìŒ

âœ…  ìœ„ì ¯ì€ í•˜ë£¨ì¢…ì¼ ë³€í™”í•˜ëŠ” ë™ì  ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” ë°ì— ì í•©

âœ…  ìœ„ì ¯ìœ¼ë¡œ ë†€ë¼ì›€ê³¼ ì¦ê±°ì›€ì„ ì¤„ ìˆ˜ ìˆìœ¼ë©´ ì¢‹ìŒ



## iPhone Widgetì´ ë³´ì—¬ì§ˆ ìˆ˜ ìˆëŠ” ê³³ 

<table style="width: 100%; table-layout: fixed;">
  <tr>
    <td style="text-align: center; padding: 10px;">
      <h3>í™ˆí™”ë©´ ìœ„ì ¯<br>(HomeScreen Widget)</h3>
      <img src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A18-Widgets/assets/121593683/72e7b8a4-d516-49b7-8990-3ae94e3f9df1" width="200" height="408">
    </td>
    <td style="text-align: center; padding: 10px;">
      <h3>ì ê¸ˆí™”ë©´ ìœ„ì ¯<br>(LockScreen Widget)</h3>
      <img src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A18-Widgets/assets/121593683/d2a4eb3f-dc2f-43da-8765-81d2283917ff" width="200" height="408">
    </td>
    <td style="text-align: center; padding: 10px;">
      <h3>ì˜¤ëŠ˜ì˜ í™”ë©´<br>(Today View)</h3>
      <img src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A18-Widgets/assets/121593683/a1fa9167-59b9-458d-a36b-9bdc55adb8c1" width="200" height="408">
    </td>
    <td style="text-align: center; padding: 10px;">
      <h3>ìœ„ì ¯ ìŠ¤íƒ<br>(Widget Stack)</h3>
      <img src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A18-Widgets/assets/121593683/f5953fda-e057-4a35-b6ce-bef2bae6f596b" width="200" height="408">
    </td>
  </tr>
</table>


## Widgetì˜ ì¢…ë¥˜ 
<img width="1704" alt="image" src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A18-Widgets/assets/121593683/3cdb4621-1020-4cbe-b9fe-452c3dcdc7ce">



## LiveActivity
Live ActivitesëŠ” ì¼ë°˜ Widget ë³´ë‹¤ ì¢€ë” ì‹¤ì‹œê°„ í˜„í™©ì„ í‘œì‹œí•˜ëŠ”ë° ìˆì–´ ìµœì í™” ëœ ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤. 


<img width="250" alt="image" src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A18-Widgets/assets/121593683/0d702c03-f963-4010-a8f2-742d2052b6a8">


1. Live Activityë¥¼ ìœ„í•œ modelì„ ì •ì˜í•©ë‹ˆë‹¤. 
    - `EclipseAttributes` : LiveActivityì—ì„œ ë³´ì—¬ì¤„ ì •ì ì¸ ê°’(ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•  í•„ìš”ì—†ëŠ” ê°’)ì„ ì •ì˜í•©ë‹ˆë‹¤.
    - `EclipseAttributes.ContentState`  : LiveActivityì—ì„œ ë³´ì—¬ì¤„ ë™ì ì¸ ê°’(ì‹¤ì‹œê°„ìœ¼ë¡œ ë³€í•´ì•¼í•˜ëŠ” ê°’)ì„ ì •ì˜í•©ë‹ˆë‹¤.
    
    ```swift
    struct EclipseAttributes: ActivityAttributes {
        public struct ContentState: Codable, Hashable {
            var progress: Double 
            var currentTime: Date 
        }
    
        var eclipseStartTime: Date
        var eclipseEndTime: Date
        var eclipseMaxTime: Date
    }
    ```
    

2. Live Activityê°€ ë³´ì—¬ì§ˆ  Viewë¥¼ ì •ì˜í•©ë‹ˆë‹¤. 

```swift
struct EclipseLiveActivity: Widget {
    var body: some WidgetConfiguration {
        ActivityConfiguration(for: EclipseAttributes.self) { context in
            // Lock screen/banner ì—ëŒ€í•œ UIëŠ” ì—¬ê¸°ì— ì •ì˜
            DynamicAtivityForLockScreen(context: context)
            
        } dynamicIsland: { context in
            // DynamicIslandì— ëŒ€í•œ UIëŠ” ì—¬ê¸°ì— ì •ì˜
            DynamicIsland {
                // DynamicIslandë¥¼ ê¾¹ ëˆŒë €ì„ ë•Œ í™•ì¥ë˜ëŠ” ì˜ì—­ì— ëŒ€í•œ ì •ì˜
                DynamicIslandExpandedRegion(.leading) {
                   // ì™¼ìª½ ìƒë‹¨ area
                    
                }
                DynamicIslandExpandedRegion(.trailing) {
                    // ì˜¤ë¥¸ìª½ ìƒë‹¨ area
                }
                DynamicIslandExpandedRegion(.bottom) {
                    // ì•„ë˜ìª½ area
                }
            } compactLeading: {
                // ë‹¤ì´ë‚˜ë¯¹ ì•„ì´ëœë“œ ì„¼ì„œë¶€ê¸°ì¤€ ì™¼ìª½
            } compactTrailing: {
                // ë‹¤ì´ë‚˜ë¯¹ ì•„ì´ëœë“œ ì„¼ì„œë¶€ê¸°ì¤€ ì˜¤ë¥¸ìª½
            } minimal: {
								// ë‹¤ë¥¸ ë‹¤ì´ë‚˜ë¯¹ ì•„ì´ëœë“œìƒê²¨ ë°€ë ¸ì„ ë•Œ ì˜¤ë¥¸ìª½ì— ì‘ê²Œ ë³´ì¼ë•Œ 
            }
            .widgetURL(URL(string: "http://www.apple.com")) // Link typeì„ í™œìš©í•˜ì—¬ í•´ë‹¹ ìœ„ì ¯ì„ ëˆŒë €ì„ ë•Œ ì•±ë‚´ì˜ ì›í•˜ëŠ” ìœ„ì¹˜ë¡œ ì‚¬ìš©ìë¥¼ direct
            .keylineTint(Color("ring"))  // dynamic island ì£¼ë³€ë¶€ì˜ ìƒ‰ì„ ê²°ì •
        }
    }
}
```

3. LiveActivityë¥¼ ì‹œì‘, ì¢…ë£Œ , ì—…ë°ì´íŠ¸ë¥¼ í•˜ëŠ” ë¡œì§ì„ êµ¬í˜„í•©ë‹ˆë‹¤. 
    a. ìƒˆë¡œìš´ LiveActivityë¥¼ ë§Œë“¤ê³  `.request` ë¥¼ í†µí•´ ì‹œì‘í•©ë‹ˆë‹¤. 
    
    ```swift
    private func startNewLiveActivity() {        
                
                // ì •ì ê°’ ì„¤ì •
                let initialAttributes = EclipseAttributes(
                    eclipseStartTime: startTime,
                    eclipseEndTime: endTime,
                    eclipseMaxTime: maxTime
                )
                
                // ë™ì  ê°’ ì„¤ì •
                let initialContentState = EclipseAttributes.ContentState(
                    progress: 0.0,
                    currentTime: Date()
                )
                // staleDate : ë”ì´ìƒ LivActivityê°€ ìœ íš¨í•˜ì§€ ì•Šì€ ì‹œì ì„ ë‚˜íƒ€ëƒ„
                let staleDate = endTime.addingTimeInterval(10) 
                // acitivityì— ê´€ë ¨í•œ ë™ì  ë°ì´í„°ëŠ” ActivityContentë¼ëŠ” wrapper ì‹¸ì„œ ë„£ì–´ì¤˜ì•¼í•¨
                let activityContent = ActivityContent(state: initialContentState, staleDate: staleDate)
                
              
                //  êµ¬ì„±í•œ initialAttributesì™€ activityContentêµ¬ì„±í•´ì„œ 
                // requestë¥¼ í†µí•´ LiveActivityë¥¼ ì‹œì‘í•©ë‹ˆë‹¤. 
                let activity = try? Activity.request(attributes: initialAttributes, content: activityContent, pushType: nil)
                
            }
            
        }
    ```
    
    b. êµ¬ì„±í•œ activityì— ëŒ€í•´ ì—…ë°ì´íŠ¸í•  ê°’ì„ ë§Œë“¤ê³  ì´ë¥¼ activityì— ì—…ë°ì´íŠ¸ í•´ì¤ë‹ˆë‹¤. 
    
    ```swift
     func updateLiveActivity() {
    
                let currentTime = Date()
                let elapsed = currentTime.timeIntervalSince(startTime)
                let duration = endTime.timeIntervalSince(startTime)
                var progress = elapsed / duration
                progress = min(max(progress, 0.0), 1.0)
    					
    						// ë™ì ê°’ì„ ìƒˆë¡­ê²Œ êµ¬ì„±í•©ë‹ˆë‹¤.             
                let updatedContentState = EclipseAttributes.ContentState(
                    progress: progress,
                    currentTime: currentTime
                )
                // ë§Œë£Œë˜ëŠ” ì‹œì ì„ êµ¬ì„±í•©ë‹ˆë‹¤. 
                let staleDate = eclipse.endDateTime?.addingTimeInterval(10) ?? Date().addingTimeInterval(10)
                // ìƒˆë¡œìš´ CotentStateë¥¼ ë§Œë“¤ì–´ 
                let activityContent = ActivityContent(state: updatedContentState, staleDate: staleDate)
                
                // í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ activityì— ì—…ë°ì´íŠ¸ë¥¼ í•´ì¤ë‹ˆë‹¤. 
                await runningActivity.update(activityContent)
             
            }
        }
    ```
    
    c. êµ¬ì„±í•œ activityë¥¼ ì¢…ë£Œí•©ë‹ˆë‹¤. 
    
    ```swift
    func endActivity() {
    					// ë§ˆì§€ë§‰ ìƒíƒœê°’ì„ êµ¬ì„±í•©ë‹ˆë‹¤. 
                let finalContentState = EclipseAttributes.ContentState(
                    progress: 1.0,
                    currentTime: runningActivity.attributes.eclipseEndTime
                )
                let staleDate = Date().addingTimeInterval(10)
                let activityContent = ActivityContent(state: finalContentState, staleDate: staleDate)
                
                // í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ liveactivityë¥¼ ëëƒ…ë‹ˆë‹¤. 
                await runningActivity.end(activityContent, dismissalPolicy: .immediate)
            }
     }       
    ```
    


## Widgets

- ìœ„ì ¯ì„ êµ¬ì„±í•  modelì„ êµ¬ì„±í•©ë‹ˆë‹¤. 

```swift
// ìœ„ì ¯ì„ êµ¬ì„±í•  ë°ì´í„°ê°€ì§„ struct
struct SimpleEntry: TimelineEntry {
    let date: Date
    let daysUntilEclipse: Int?
    let moonPhase: String
    let configuration: ConfigurationAppIntent
}
```

- ìœ„ì ¯ì˜ ë””í´íŠ¸ ìƒíƒœ, ë¯¸ë¦¬ë³´ê¸° ìƒíƒœ, ê°’ì˜ ì—…ë°ì´íŠ¸ ë°©ë²•ì„ ì •ì˜í•©ë‹ˆë‹¤. 

```swift
struct Provider: AppIntentTimelineProvider {

    // ì´ ë©”ì„œë“œëŠ” ìœ„ì ¯ì´ ì•„ì§ ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì§€ ì•Šì•˜ì„ ë•Œ í‘œì‹œí•  ê¸°ë³¸ ë·°ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ë¹ ë¥´ê²Œ ë¡œë“œë˜ë©°, ì„ì‹œ ë°ì´í„°ë¥¼ ì‚¬ìš©
    func placeholder(in context: Context) -> SimpleEntry {
       
    }

    // ì´ ë©”ì„œë“œëŠ” ìœ„ì ¯ ê°¤ëŸ¬ë¦¬ì—ì„œ ë˜ëŠ” ë¹ ë¥¸ ë¯¸ë¦¬ë³´ê¸°ê°€ í•„ìš”í•  ë•Œ í˜¸ì¶œë©ë‹ˆë‹¤. í˜„ì¬ ìƒíƒœì˜ ìŠ¤ëƒ…ìƒ·ì„ ì œê³µ
    func snapshot(for configuration: ConfigurationAppIntent, in context: Context) async -> SimpleEntry {
        
        
    }
    
    // ìœ„ì ¯ì— í‘œì‹œí•  ì •ë³´ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•œ ë©”ì„œë“œ
    func timeline(for configuration: ConfigurationAppIntent, in context: Context) async -> Timeline<SimpleEntry> {
      
    }

}
```

- ìœ„ì ¯ì˜ ë·°ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤. (ê°ê°ì˜ WidgetFamilyì— ëŒ€í•´ êµ¬í˜„) 

```swift
struct EclipseWidgetEntryView: View {
    @Environment(\.widgetFamily) var family: WidgetFamily
    var entry: Provider.Entry

    var body: some View {
        switch family {
        case .systemSmall:
            SmallEclipseWidgetView(entry: entry)
        case .systemMedium:
            MediumEclipseWidgetView(entry: entry)
        case .systemLarge:
            LargeEclipseWidgetView(entry: entry)
        case .accessoryCircular:
            AccessoryCircularEclipseWidgetView(entry: entry)
        case .accessoryRectangular:
            AccessoryRectangularEclipseWidgetView(entry: entry)
        case .accessoryInline:
            AccessoryInlineEclipseWidgetView(entry: entry)
        default:
            SmallEclipseWidgetView(entry: entry)
        }
    }
}
```
- ìœ„ì ¯ì„ êµ¬ì„±í•©ë‹ˆë‹¤. 

```swift
struct EclipseWidget: Widget {
    let kind: String = "DalADalAWidget"

    var body: some WidgetConfiguration {
        AppIntentConfiguration(kind: kind, intent: ConfigurationAppIntent.self, provider: Provider()) { entry in
            EclipseWidgetEntryView(entry: entry)
                .containerBackground(for: .widget){
                    LinearGradient(colors: [Color("widgetback"), Color("widgetback2")], startPoint: .top, endPoint: .bottom)
                }
        }
        .configurationDisplayName("Eclipse Widget")
        .description("Shows the days until the next eclipse and the current moon phase.")
        // Widget family ì¤‘ í˜„ì¬ appì—ì„œ ì§€ì›í•  widgetì„ ì„ íƒ 
        .supportedFamilies([.systemSmall, .systemMedium, .systemLarge,  .accessoryCircular, .accessoryRectangular, .accessoryInline])
    }
}
```


## ê¸°ìˆ  ì°¸ê³  ì‚¬í•­

<aside>
ğŸ’¡ Appì´ ë°±ê·¸ë¼ìš´ë“œ ìƒíƒœê°€ ë˜ë©´ ì•±ìœ¼ë¡œë¶€í„° LiveActivityì˜ ê°’ì„ ì—…ë°ì´íŠ¸ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

</aside>

- appì´ í¬ì–´ê·¸ë¼ìš´ë“œ ìƒíƒœì— ìˆëŠ” ê²½ìš°, ì•±ì„ í†µí•´ LiveActivity ê°’ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì‹¤ì‹œê°„ í˜„í™©ì„ í‘œì‹œí•˜ê¸° ìœ„í•œ ì»´í¬ë„ŒíŠ¸ê°€ ë³„ë„ë¡œ ì¡´ì¬í•©ë‹ˆë‹¤. 
Text ë˜ëŠ” ProgressView ëŠ” iOS 16ì´ìƒì—ì„œ rangeë¥¼ í†µí•´ ê°’ì„ ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- Background TaskëŠ” Music, Carplay, Mapê³¼ ê°™ì´ ì‹¤ì‹œê°„ í˜„í™©ì´ ì¤‘ìš”í•œ ì–´í”Œì˜ ê²½ìš°ë§Œ í—ˆìš©í•©ë‹ˆë‹¤.
- Appì´ ë°±ê·¸ë¼ìš´ë“œ ìƒíƒœì— ìˆì„ ë•Œì—ë„ ì‹¤ì‹œê°„ìœ¼ë¡œ í˜„í™©ì„ ì—…ë°ì´íŠ¸ í•´ì£¼ê¸° ìœ„í•´ì„œëŠ” push notificationì„ í†µí•´ì„œ ì„œë²„ë¥¼ í†µí•´ ê°’ì„ ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- Info plistì—  `Supports Live Activities` key ê°’ì„ ì¶”ê°€í•´ì•¼í•©ë‹ˆë‹¤.



















